name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = pbi, aes(x = ANIO, y = PBI * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
####graficos
graf1<-primer_semestre_mes %>% ggplot(aes(x=fecha, y=total)) + geom_col()
graf1
#Grafico de linea y barra - Entradas y PBI
# Ajustar el coeficiente de escala
coef <- 30000  # Ajustar este valor según sea necesario
# Definir los límites del eje secundario
sec_axis_limits <- c(-15, 15)
primary_axis_limits <- sec_axis_limits * coef
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = pbi, aes(x = ANIO, y = PBI * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
primer_trimestre<-primer_semestre %>% filter(meses<3)
###carga de TC
tc<-read.csv("data/ITCRM.csv")
tc
###carga de TC
tc<-read.csv("data/ITCRM.csv")
tc
###carga de TC
tc<-read.csv("data/ITCRM.csv", sep = ";")
tc
tc$ANIO<-tc$ï..Etiquetas.de.fila
tc<-tc %>% select(-ï..Etiquetas.de.fila)
tc
tc<-tc %>% select(-ï..Etiquetas.de.fila, -Meses, -Promedio.de.ITCRM)
###carga de TC
tc<-read.csv("data/ITCRM.csv", sep = ";")
tc$ANIO<-tc$ï..Etiquetas.de.fila
tc$MES<-tc$Meses
tc$tipo_cambio<-tc$Promedio.de.ITCRM
tc<-tc %>% select(-ï..Etiquetas.de.fila, -Meses, -Promedio.de.ITCRM)
tc
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tc * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
View(tc)
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
#Grafico de linea y barra - Entradas y PBI
# Ajustar el coeficiente de escala
coef <- 30000  # Ajustar este valor según sea necesario
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
str(tc)
tc$tipo_cambio<-as.numeric(tc$tipo_cambio)
str(tc)
###carga de TC
tc<-read.csv("data/ITCRM.csv", sep = ";")
tc$ANIO<-tc$ï..Etiquetas.de.fila
tc$MES<-tc$Meses
tc$tipo_cambio<-tc$Promedio.de.ITCRM
tc<-tc %>% select(-ï..Etiquetas.de.fila, -Meses, -Promedio.de.ITCRM)
tc$tipo_cambio <- gsub(",", ".", tc$tipo_cambio)
tc$tipo_cambio<-as.numeric(tc$tipo_cambio)
str(tc)
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
tc$ANIO<-as.factor(tc$ANIO)
tc$tipo_cambio <- gsub(",", ".", tc$tipo_cambio)
tc$tipo_cambio<-as.numeric(tc$tipo_cambio)
str(tc)
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
#Grafico de linea y barra - Entradas y PBI
# Ajustar el coeficiente de escala
coef <- 10000  # Ajustar este valor según sea necesario
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
#Grafico de linea y barra - Entradas y PBI
# Ajustar el coeficiente de escala
coef <- 1000  # Ajustar este valor según sea necesario
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
# Definir los límites del eje secundario
sec_axis_limits <- c(0, 150)
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
# Definir los límites del eje secundario
sec_axis_limits <- c(0, 150)
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
# Definir los límites del eje secundario
sec_axis_limits <- c(70, 150)
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
#Grafico de linea y barra - Entradas y PBI
# Ajustar el coeficiente de escala
coef <- 100  # Ajustar este valor según sea necesario
# Definir los límites del eje secundario
sec_axis_limits <- c(70, 150)
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
# Definir los límites del eje secundario
sec_axis_limits <- c(0, 15)
primary_axis_limits <- sec_axis_limits * coef
primer_trimestre<-primer_semestre %>% filter(meses<3)
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = pbi, aes(x = ANIO, y = PBI * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
# Definir los límites del eje secundario
sec_axis_limits <- c(70, 150)
primary_axis_limits <- sec_axis_limits * coef
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
#Grafico de linea y barra - Entradas y PBI
# Ajustar el coeficiente de escala
coef <- 1000  # Ajustar este valor según sea necesario
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
# Definir los límites del eje secundario
sec_axis_limits <- c(70, 150)
primary_axis_limits <- sec_axis_limits * coef
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
# Definir los límites del eje secundario
coef<-5000
sec_axis_limits <- c(70, 150)
primary_axis_limits <- sec_axis_limits * coef
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
# Definir los límites del eje secundario
coef<-1000
sec_axis_limits <- c(70, 150)
primary_axis_limits <- sec_axis_limits * coef
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
# Definir los límites del eje secundario
coef<-2000
primary_axis_limits <- sec_axis_limits * coef
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
# Definir los límites del eje secundario
coef<-2500
sec_axis_limits <- c(70, 150)
primary_axis_limits <- sec_axis_limits * coef
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
tc
tc<-tc %>% group_by(ANIO) %>% summarise(tipo_cambio=mean(tipo_cambio))
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
###carga de TC
tc<-read.csv("data/ITCRM.csv", sep = ";")
tc$ANIO<-tc$ï..Etiquetas.de.fila
tc$MES<-tc$Meses
tc$tipo_cambio<-tc$Promedio.de.ITCRM
tc<-tc %>% select(-ï..Etiquetas.de.fila, -Meses, -Promedio.de.ITCRM)
tc<-tc %>% mutate(ANIO=ANIO+1)
tc$ANIO<-as.factor(tc$ANIO)
tc$tipo_cambio <- gsub(",", ".", tc$tipo_cambio)
tc$tipo_cambio<-as.numeric(tc$tipo_cambio)
tc<-tc %>% group_by(ANIO) %>% summarise(tipo_cambio=mean(tipo_cambio))
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
###carga de TC
tc<-read.csv("data/ITCRM.csv", sep = ";")
tc$ANIO<-tc$ï..Etiquetas.de.fila
tc$MES<-tc$Meses
tc$tipo_cambio<-tc$Promedio.de.ITCRM
tc<-tc %>% select(-ï..Etiquetas.de.fila, -Meses, -Promedio.de.ITCRM)
tc<-tc %>% mutate(ANIO=ANIO)
tc$ANIO<-as.factor(tc$ANIO)
tc$tipo_cambio <- gsub(",", ".", tc$tipo_cambio)
tc$tipo_cambio<-as.numeric(tc$tipo_cambio)
tc<-tc %>% group_by(ANIO) %>% summarise(tipo_cambio=mean(tipo_cambio))
ggplot(primer_semestre, aes(x = ANIO)) +
geom_col(aes(y = total), fill = "blue") +
geom_line(data = tc, aes(x = ANIO, y = tipo_cambio * coef, group = 1), color = "red", size=3 ) +
scale_y_continuous(
name = "Total",
sec.axis = sec_axis(~ . / coef, name = "PBI")
) +
coord_cartesian(ylim = primary_axis_limits) +
theme_minimal() +
labs(x = "Año", y = "Total") +
theme(
axis.title.y = element_text(color = "blue"),
axis.title.y.right = element_text(color = "red")
)
View(tabla_combinada)
tabla_combinada$porc_previaje<-(tabla_combinada$total_viajeros/tabla_combinada$INGRESOS)*100
View(tabla_combinada)
plot(tabla_combinada$INGRESOS, tabla_combinada$porc_previaje)
plot(tabla_combinada$total_viajeros, tabla_combinada$INGRESOS)
cor(tabla_combinada$total_viajeros, tabla_combinada$INGRESOS)
cor(na.omit((tabla_combinada$total_viajeros, tabla_combinada$INGRESOS))
cor(na.omit((tabla_combinada$total_viajeros, tabla_combinada$INGRESOS)))
tabla_combinada<-tabla_combinada %>% mutate(total_viajeros2=ifelse(isna(total_viajeros), 0, tota))
tabla_combinada<-tabla_combinada %>% mutate(total_viajeros2=ifelse(isna(total_viajeros), 0, total_viajeros))
tabla_combinada<-tabla_combinada %>% mutate(total_viajeros2=ifelse(is.na(total_viajeros), 0, total_viajeros))
cor(tabla_combinada$INGRESOS, tabla_combinada$total_viajeros2)
enero<-tabla_combinada %>% filter(month(fecha)=1)
enero<-tabla_combinada %>% filter(month(fecha)==1)
enero
cor(enero$INGRESOS, enero$total_viajeros2)
plot(enero$INGRESOS, enero$total_viajeros2)
cor(pbi$PBI, tabla_combinada$INGRESOS)
cor(pbi$PBI, primer_semestre$INGRESOS)
cor(pbi$PBI, primer_semestre$total)
plot(pbi$PBI, primer_semestre$total)
View(TODO)
valores_entradas<-read_excel("data/VALORES entradas.xlsx")
valores_entradas$FECHA<-as.Date(valores_entradas$FECHA, format='%Y-%m-%d')
valores_entradas
View(valores_entradas)
valores_entradas<-read_excel("data/VALORES entradas.xlsx")
valores_entradas$FECHA<-as.Date(valores_entradas$FECHA, format='%Y-%m-%d')
tabla_combinada$montos_ingresos<-tabla_combinada$INGRESOS*tabla_combinada$
#Grafico de linea y barra - Entradas y PBI
# Ajustar el coeficiente de escala
coef <- 1000  # Ajustar este valor según sea necesario
valores_entradas<-read_excel("data/VALORES entradas.xlsx")
valores_entradas$FECHA<-as.Date(valores_entradas$FECHA, format='%Y-%m-%d')
valores_entradas$fecha<-as.Date(valores_entradas$fecha, format='%Y-%m-%d')
tabla_combinada$montos_ingresos<-tabla_combinada$INGRESOS*tabla_combinada$
#Grafico de linea y barra - Entradas y PBI
# Ajustar el coeficiente de escala
coef <- 1000  # Ajustar este valor según sea necesario
tabla_combinada$montos_ingresos<-tabla_combinada$INGRESOS*tabla_combinada
tabla_combinada$montos_ingresos<-tabla_combinada$INGRESOS*tabla_combinada
tabla_combinada<-left_join(tabla_combinada, valores_entradas, by="fecha")
tabla_combinada
valores_entradas$fecha<-as.Date(valores_entradas$fecha, format='%Y-%m-%d')
tabla_combinada$montos_ingresos<-tabla_combinada$INGRESOS*tabla_combinada
tabla_combinada$montos_ingresos<-tabla_combinada$INGRESOS*tabla_combinada$`ENTRADA PROMEDIO`
View(tabla_combinada)
